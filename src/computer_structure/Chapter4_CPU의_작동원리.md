
# 04-1 ALU와 제어장치

## ALU

ALU는 레지스터를 통해 피연산자와 제어장치로부터 수행할 연산을 알려주는 제어 신호를 받아들이고
계산한 특정문자나 숫자, 메모리 주소와 플래그를 내보낸다. (이때, 메모리에 저장되지 않고 일시적으로 레지스터에 저장된다.)

- 플래그 종류
1. 부호 플래그
2. 제로 플래그
3. 캐리 플래그
4. 오버플로우 플래그
5. 인터럽트 플래그
6. 슈퍼바이저 플래그


## 제어장치

제어장치 : 제어 신호를 내보내고, 명령어를 해석하는 부품

1. 제어장치는 클럭 신호를 받아들입니다.
2. 제어장치는 '해석해야 할 명령어'를 받아들입니다.
3. 제어장치는 플래그 레지스터 속 '플래그 값'를 받아들입니다.
4. 제어 장치는 시스템 버스. 그 중에서 제어 버스로 전달된 제어 신호를 받아들입니다.


# 4-2 레지스터

## 반드시 알아야 하는 레지스터

1. 프로그램 카운터
- 메모리에서 읽어 들일 메모리의 주소를 저장
2. 명령어 레지스터
- 메모리에서 읽어 들인 명령어를 저장
3. 메모리 주소 레지스터
- 메모리의 주소를 저장
4. 메모리 버퍼 레지스터
- 메모리와 주고 받을 값을 저장
5. 플래그 레지스터
- ALU 연산 결과에 따른 플래그 저장
6. 범용 레지스터
- 메모리 버퍼 레지스터와 메모리 주소 레지스터는 각각 데이터 버스와 주소 버로 주고 받을 값만 저장하지만
  범용 레지스터는 데이터와 주소 모두 저장할 수 있다.
7. 스택 포인터
8. 베이스 레지스터

## 스택 주소 지정 방식
- 스택과 스택 포인터를 이용한 주소 지정 방식

## 변위 주소 지정 방식
- 오퍼랜드 필드 값과 특정 레지스터 값을 더하여 유효 주소를 얻어 내는 주소 지정 방식
- 오퍼랜드 필드의 주소와 어떤 레지스터를 더하는지에 따라 상대 주소 지정 방식, 베이스 레지스터 주소 지정 방식 등으로 나뉨

### 상대 주소 지정 방식
- 오퍼랜드 필드 값과 프로그램 카운터의 값을 더하여 유효 주소를 얻는 방식

### 베이스 레지스터 주소 지정 방식
- 오퍼랜드와 베이스 레지스터의 값을 더하여 유효 주소를 얻는 방식
- 베이스 레지스터는 '기준 주소' 오퍼랜드는 '기준 주소로부터 떨어진 거리'로서의 역할을 한다.


# 4-3 명령어 사이클과 인터럽트

- 명령어 사이클 : 하나의 명령어를 처리하는 정형화된 흐름
- (인출 - 간접 - 실행 - 인터럽트) 사이클



- 인터럽트 : 특정한 이유로 인해 CPU의 작업을 방해(중단)하는 신호

1. 동기 인터럽트(예외 인터럽트) : CPU에 의해 발생하는 인터럽트. CPU가 명령어들을 수행하다가 예상치 못한 상황을 마주 쳤을 때 발생
2. 비동기 인터럽트(하드웨어 인터럽트) : 주로 입출력장치에 의해 발생하는 인터럽트. 입출력장치에 의한 인터럽트는 세탁기 완료 알림 등
과 같이 알림 역할을 한다. CPU에 의해 입출력장치가 현저히 느리므로 입출력 결과를 바로 알 수 없어 주기적으로 확인해야 돼서  
CPU 사이클이 낭비된다. 그러므로 효율적으로 명령어를 처리하기 위해 비동기 인터럽트를 사용한다.

## 하드웨어 인터럽트(비동기 인터럽트) 실행 순서

1. 입출력 장치는 CPU에 인터럽트 요청 신호를 보낸다
2. CPU는 실행 사이클이 끝나고 명령어를 인출하기 전 항상 인터럽트 여부를 확인한다.
3. CPU는 인터럽트 요청을 확인하고 인터럽트 플래그를 통해 현재 인터럽트 요청을 받아들일 수 있는지 확인한다.
4. 인터럽트를 받아들일 수 있다면 현재까지의 작업을 백업한다.
5. CPU는 인터럽트 백터를 참조하여 인터럽트 서비스 루틴을 실행한다.
6. 인터럽트 서비스 루틴이 끝나면 백업해둔 작업을 실행한다.


## 예외의 종류

동기 인터럽트 
1. 폴트 : 예외를 처리한 다음 예외가 발생한 명령어부터 처리 (ex. 명령어를 처리하기 위해 메모리가 필요한 경우)
2. 트랩 : 예외를 처리한 다음 예외가 발생한 명령어를 넘기고 다음 명령어부터 처리 (ex. 디버깅)\
3. 중단 : CPU가 실행중인 프로그램을 강제로 중단시킬 수 밖에 없는 심각한 오류를 발견했을 때 발생
4. 소프트웨어 인터럽트 : 시스템 호출이 발생할 떄 나타남






